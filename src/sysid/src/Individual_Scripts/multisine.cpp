#include<ros/ros.h> // Header file which allows the use of ROS related commands and functions
#include<mavros_msgs/State.h> // Header file which enables processing data related to the Pixhawk status (e.g. Armed, connected, etc...)
#include<mavros_msgs/ActuatorControl.h> // Header file which enables processing data related to actuator control
#include<mavros_msgs/ManualControl.h> // Header file which enables processing data related to actuator control based on RC input
#include<mavros_msgs/RCIn.h> // Header file which enables processing data related to RC signal values
using namespace std; // Saves us the trouble of having to write "std::" in front of every other function we use

mavros_msgs::State current_state;// Initializes global variable to store the state of the Pixhawk (e.g. if connected or not)
void state_cb(const mavros_msgs::State::ConstPtr& msg){// call back function to read & store the state of the Pixhawk
	current_state = *msg;}

mavros_msgs::RCIn rc_input;// Initializes global variable to store the read RC inputs
void rcin_cb(const mavros_msgs::RCIn::ConstPtr& msg){// call back function to read & store the RC input
	rc_input = *msg;}

mavros_msgs::ManualControl manual_input;// Initializes global variable to store the read normalized manual control input values
void manual_cb(const mavros_msgs::ManualControl::ConstPtr& msg){// Call back function to read and store normalized manual control inputs
	manual_input = *msg;}
/*
mavros_msgs::Actuator actuator_data;// Initializes global variable to store the read actuator control
void actuator_cb(const mavros_msgs::ActuatorControl::ConstPtr& msg){
	actuator_data = *msg;}*/
double* t_init(){
	static double t[1001]={0,0.02,0.04,0.06,0.08,0.1,0.12,0.14,0.16,0.18,0.2,0.22,0.24,0.26,0.28,0.3,0.32,0.34,0.36,0.38,0.4,0.42,0.44,0.46,0.48,0.5,0.52,0.54,0.56,0.58,0.6,0.62,0.64,0.66,0.68,0.7,0.72,0.74,0.76,0.78,0.8,0.82,0.84,0.86,0.88,0.9,0.92,0.94,0.96,0.98,1,1.02,1.04,1.06,1.08,1.1,1.12,1.14,1.16,1.18,1.2,1.22,1.24,1.26,1.28,1.3,1.32,1.34,1.36,1.38,1.4,1.42,1.44,1.46,1.48,1.5,1.52,1.54,1.56,1.58,1.6,1.62,1.64,1.66,1.68,1.7,1.72,1.74,1.76,1.78,1.8,1.82,1.84,1.86,1.88,1.9,1.92,1.94,1.96,1.98,2,2.02,2.04,2.06,2.08,2.1,2.12,2.14,2.16,2.18,2.2,2.22,2.24,2.26,2.28,2.3,2.32,2.34,2.36,2.38,2.4,2.42,2.44,2.46,2.48,2.5,2.52,2.54,2.56,2.58,2.6,2.62,2.64,2.66,2.68,2.7,2.72,2.74,2.76,2.78,2.8,2.82,2.84,2.86,2.88,2.9,2.92,2.94,2.96,2.98,3,3.02,3.04,3.06,3.08,3.1,3.12,3.14,3.16,3.18,3.2,3.22,3.24,3.26,3.28,3.3,3.32,3.34,3.36,3.38,3.4,3.42,3.44,3.46,3.48,3.5,3.52,3.54,3.56,3.58,3.6,3.62,3.64,3.66,3.68,3.7,3.72,3.74,3.76,3.78,3.8,3.82,3.84,3.86,3.88,3.9,3.92,3.94,3.96,3.98,4,4.02,4.04,4.06,4.08,4.1,4.12,4.14,4.16,4.18,4.2,4.22,4.24,4.26,4.28,4.3,4.32,4.34,4.36,4.38,4.4,4.42,4.44,4.46,4.48,4.5,4.52,4.54,4.56,4.58,4.6,4.62,4.64,4.66,4.68,4.7,4.72,4.74,4.76,4.78,4.8,4.82,4.84,4.86,4.88,4.9,4.92,4.94,4.96,4.98,5,5.02,5.04,5.06,5.08,5.1,5.12,5.14,5.16,5.18,5.2,5.22,5.24,5.26,5.28,5.3,5.32,5.34,5.36,5.38,5.4,5.42,5.44,5.46,5.48,5.5,5.52,5.54,5.56,5.58,5.6,5.62,5.64,5.66,5.68,5.7,5.72,5.74,5.76,5.78,5.8,5.82,5.84,5.86,5.88,5.9,5.92,5.94,5.96,5.98,6,6.02,6.04,6.06,6.08,6.1,6.12,6.14,6.16,6.18,6.2,6.22,6.24,6.26,6.28,6.3,6.32,6.34,6.36,6.38,6.4,6.42,6.44,6.46,6.48,6.5,6.52,6.54,6.56,6.58,6.6,6.62,6.64,6.66,6.68,6.7,6.72,6.74,6.76,6.78,6.8,6.82,6.84,6.86,6.88,6.9,6.92,6.94,6.96,6.98,7,7.02,7.04,7.06,7.08,7.1,7.12,7.14,7.16,7.18,7.2,7.22,7.24,7.26,7.28,7.3,7.32,7.34,7.36,7.38,7.4,7.42,7.44,7.46,7.48,7.5,7.52,7.54,7.56,7.58,7.6,7.62,7.64,7.66,7.68,7.7,7.72,7.74,7.76,7.78,7.8,7.82,7.84,7.86,7.88,7.9,7.92,7.94,7.96,7.98,8,8.02,8.04,8.06,8.08,8.1,8.12,8.14,8.16,8.18,8.2,8.22,8.24,8.26,8.28,8.3,8.32,8.34,8.36,8.38,8.4,8.42,8.44,8.46,8.48,8.5,8.52,8.54,8.56,8.58,8.6,8.62,8.64,8.66,8.68,8.7,8.72,8.74,8.76,8.78,8.8,8.82,8.84,8.86,8.88,8.9,8.92,8.94,8.96,8.98,9,9.02,9.04,9.06,9.08,9.1,9.12,9.14,9.16,9.18,9.2,9.22,9.24,9.26,9.28,9.3,9.32,9.34,9.36,9.38,9.4,9.42,9.44,9.46,9.48,9.5,9.52,9.54,9.56,9.58,9.6,9.62,9.64,9.66,9.68,9.7,9.72,9.74,9.76,9.78,9.8,9.82,9.84,9.86,9.88,9.9,9.92,9.94,9.96,9.98,10,10.02,10.04,10.06,10.08,10.1,10.12,10.14,10.16,10.18,10.2,10.22,10.24,10.26,10.28,10.3,10.32,10.34,10.36,10.38,10.4,10.42,10.44,10.46,10.48,10.5,10.52,10.54,10.56,10.58,10.6,10.62,10.64,10.66,10.68,10.7,10.72,10.74,10.76,10.78,10.8,10.82,10.84,10.86,10.88,10.9,10.92,10.94,10.96,10.98,11,11.02,11.04,11.06,11.08,11.1,11.12,11.14,11.16,11.18,11.2,11.22,11.24,11.26,11.28,11.3,11.32,11.34,11.36,11.38,11.4,11.42,11.44,11.46,11.48,11.5,11.52,11.54,11.56,11.58,11.6,11.62,11.64,11.66,11.68,11.7,11.72,11.74,11.76,11.78,11.8,11.82,11.84,11.86,11.88,11.9,11.92,11.94,11.96,11.98,12,12.02,12.04,12.06,12.08,12.1,12.12,12.14,12.16,12.18,12.2,12.22,12.24,12.26,12.28,12.3,12.32,12.34,12.36,12.38,12.4,12.42,12.44,12.46,12.48,12.5,12.52,12.54,12.56,12.58,12.6,12.62,12.64,12.66,12.68,12.7,12.72,12.74,12.76,12.78,12.8,12.82,12.84,12.86,12.88,12.9,12.92,12.94,12.96,12.98,13,13.02,13.04,13.06,13.08,13.1,13.12,13.14,13.16,13.18,13.2,13.22,13.24,13.26,13.28,13.3,13.32,13.34,13.36,13.38,13.4,13.42,13.44,13.46,13.48,13.5,13.52,13.54,13.56,13.58,13.6,13.62,13.64,13.66,13.68,13.7,13.72,13.74,13.76,13.78,13.8,13.82,13.84,13.86,13.88,13.9,13.92,13.94,13.96,13.98,14,14.02,14.04,14.06,14.08,14.1,14.12,14.14,14.16,14.18,14.2,14.22,14.24,14.26,14.28,14.3,14.32,14.34,14.36,14.38,14.4,14.42,14.44,14.46,14.48,14.5,14.52,14.54,14.56,14.58,14.6,14.62,14.64,14.66,14.68,14.7,14.72,14.74,14.76,14.78,14.8,14.82,14.84,14.86,14.88,14.9,14.92,14.94,14.96,14.98,15,15.02,15.04,15.06,15.08,15.1,15.12,15.14,15.16,15.18,15.2,15.22,15.24,15.26,15.28,15.3,15.32,15.34,15.36,15.38,15.4,15.42,15.44,15.46,15.48,15.5,15.52,15.54,15.56,15.58,15.6,15.62,15.64,15.66,15.68,15.7,15.72,15.74,15.76,15.78,15.8,15.82,15.84,15.86,15.88,15.9,15.92,15.94,15.96,15.98,16,16.02,16.04,16.06,16.08,16.1,16.12,16.14,16.16,16.18,16.2,16.22,16.24,16.26,16.28,16.3,16.32,16.34,16.36,16.38,16.4,16.42,16.44,16.46,16.48,16.5,16.52,16.54,16.56,16.58,16.6,16.62,16.64,16.66,16.68,16.7,16.72,16.74,16.76,16.78,16.8,16.82,16.84,16.86,16.88,16.9,16.92,16.94,16.96,16.98,17,17.02,17.04,17.06,17.08,17.1,17.12,17.14,17.16,17.18,17.2,17.22,17.24,17.26,17.28,17.3,17.32,17.34,17.36,17.38,17.4,17.42,17.44,17.46,17.48,17.5,17.52,17.54,17.56,17.58,17.6,17.62,17.64,17.66,17.68,17.7,17.72,17.74,17.76,17.78,17.8,17.82,17.84,17.86,17.88,17.9,17.92,17.94,17.96,17.98,18,18.02,18.04,18.06,18.08,18.1,18.12,18.14,18.16,18.18,18.2,18.22,18.24,18.26,18.28,18.3,18.32,18.34,18.36,18.38,18.4,18.42,18.44,18.46,18.48,18.5,18.52,18.54,18.56,18.58,18.6,18.62,18.64,18.66,18.68,18.7,18.72,18.74,18.76,18.78,18.8,18.82,18.84,18.86,18.88,18.9,18.92,18.94,18.96,18.98,19,19.02,19.04,19.06,19.08,19.1,19.12,19.14,19.16,19.18,19.2,19.22,19.24,19.26,19.28,19.3,19.32,19.34,19.36,19.38,19.4,19.42,19.44,19.46,19.48,19.5,19.52,19.54,19.56,19.58,19.6,19.62,19.64,19.66,19.68,19.7,19.72,19.74,19.76,19.78,19.8,19.82,19.84,19.86,19.88,19.9,19.92,19.94,19.96,19.98,20};
	return t;}
double* dA_init(){
	static double dA[1001]={-0.000793236816411874,-0.173905598143518,-0.339608490380027,-0.492395006360268,-0.627444662448089,-0.740774376452873,-0.829345459016632,-0.891124433676456,-0.925097837162435,-0.931243351440343,-0.910461574760386,-0.864474360793324,-0.795696875340204,-0.707091296663014,-0.60201040211932,-0.484039150517514,-0.356841820854508,-0.224021359616905,-0.0889963935825048,0.0451000317672796,0.175497434615965,0.299839569572022,0.416211211857239,0.523141774558637,0.619588565040431,0.704903306610981,0.778786077829992,0.841231045105445,0.892468294665045,0.9329057356969,0.96307449078401,0.983580467768532,0.995063981515288,0.99816843044813,0.993518195551092,0.98170517743396,0.963282769316432,0.938765617222849,0.908633265633219,0.873335734091406,0.833299209105475,0.788930342960515,0.740618091337839,0.688732549987106,0.633620816273341,0.575600451286671,0.514951601326173,0.451909208630124,0.386656964007025,0.319324704155631,0.249990823332181,0.178690956709268,0.105433719957484,0.0302236884320117,-0.0469088865833612,-0.125872845809476,-0.206477289836584,-0.288391675183263,-0.371107842681405,-0.453907274154449,-0.535836944620629,-0.615696965258486,-0.69204279041907,-0.763204100482349,-0.827321598911682,-0.882401920085842,-0.926389691863738,-0.957254601526347,-0.973090150617507,-0.972219730313872,-0.953304778667862,-0.915449161249513,-0.858293602177442,-0.782094022093497,-0.687778033028185,-0.576974595938206,-0.452012941669345,-0.315888245489667,-0.172193164832856,-0.0250161186300219,0.12119098866731,0.2617711151972,0.392040385733455,0.507478847770572,0.603925121667895,0.677765739305236,0.726109777440883,0.746939692024872,0.739230050935692,0.703027120647084,0.639483936253984,0.550847498626426,0.440397000749739,0.312334374883667,0.171630850002351,0.0238354882202678,-0.12514629416924,-0.269294534551947,-0.402725946698564,-0.519942945083835,-0.61606873506935,-0.687057205708378,-0.729867416283158,-0.742594059307032,-0.724547337516211,-0.676278110246173,-0.599546824470789,-0.497237511893685,-0.373220862471841,-0.232172933378549,-0.0793582853108122,0.0796118648365732,0.23903462261989,0.39337101473221,0.537489680583478,0.666886761607186,0.777871342973978,0.867707606810456,0.934707121522091,0.978267299582315,0.998854868299689,0.99793606505896,0.977858037193607,0.941688448559297,0.893022434470221,0.835767688697033,0.773919522207648,0.711338146467078,0.651540182562446,0.597515495640211,0.551578952225453,0.515264679032821,0.489267977504018,0.473437352610194,0.466816296653517,0.467731685012522,0.473923045399644,0.482704699338641,0.491150969996409,0.496293404610013,0.495318341886964,0.485753199278991,0.465630559275888,0.433620458198965,0.389123150884819,0.332316934821313,0.264158237403885,0.186333951913619,0.101168793938917,0.0114930819171043,-0.0795213269088813,-0.168547324049868,-0.252300097118982,-0.327734256476233,-0.392228813514158,-0.443748911393829,-0.480974480942536,-0.503387840985863,-0.511314581923474,-0.50591473483058,-0.489124086496307,-0.463548392365578,-0.432316000156771,-0.398896869080339,-0.366898010374585,-0.339846864904791,-0.32097498361021,-0.313014532773883,-0.318019593206882,-0.33722298499756,-0.3709374906303,-0.418507967543174,-0.478318065179688,-0.547852243017381,-0.623810691442443,-0.70227175880699,-0.778893753722826,-0.849145676431959,-0.908554669711874,-0.952956871394497,-0.978737964853281,-0.983050088881144,-0.963992871049519,-0.920748134842058,-0.853660208396255,-0.764256606087205,-0.655207011429941,-0.530221790529557,-0.393894530220878,-0.251496145574857,-0.108730769723075,0.0285342229722145,0.154550221247822,0.263966816283233,0.352094110156059,0.415134136745793,0.450369190344115,0.456297071177427,0.432706015942645,0.380685238092108,0.302570387603508,0.201826671004937,0.0828756641543541,-0.0491251755111153,-0.188538795138884,-0.329527247863971,-0.466338261851966,-0.593584744976661,-0.706502709699093,-0.80117429759262,-0.874704491034153,-0.925342616837524,-0.952542735793929,-0.956960310229724,-0.940385969024643,-0.905620559347586,-0.856298803272859,-0.796671595433611,-0.731359137673829,-0.665088591814014,-0.60243066289416,-0.547549464896801,-0.503979174875675,-0.474439398756786,-0.460698942468072,-0.46349493063465,-0.482511095560128,-0.516415745358452,-0.562956596077067,-0.619106502844112,-0.68125132385834,-0.745408853136807,-0.807466089830194,-0.863421164866258,-0.909616070673181,-0.942946944664448,-0.961040006431476,-0.962383265078611,-0.946406682533036,-0.91350645582261,-0.865012298343695,-0.803099875752062,-0.730653701724675,-0.651088644882099,-0.568140579963477,-0.485638499127925,-0.407271481670761,-0.336364240268391,-0.275674499534181,-0.227224242421289,-0.192174948628443,-0.170754452328725,-0.162240103021128,-0.164999687309958,-0.176588241519125,-0.193895642174433,-0.213336886444735,-0.2310744363329,-0.243260043852132,-0.246282212976692,-0.23700496305305,-0.212983870400911,-0.172646468423234,-0.115425926151942,-0.0418394042174766,0.046494526691441,0.146901687881281,0.255760101590833,0.368665123117337,0.48064395989091,0.586408786409715,0.680635366321192,0.758252482605445,0.814726647221982,0.846326564296338,0.850352662710235,0.82531865624161,0.771074450195616,0.688862671675803,0.581304502458992,0.452314160530947,0.306945115383639,0.151174735170349,-0.00836264130976134,-0.164681413941683,-0.310774261446242,-0.439949166078991,-0.546157018404132,-0.624293209809528,-0.670457789938347,-0.682160735107502,-0.658461542150482,-0.600035593438841,-0.509163367217632,-0.389642406373683,-0.246625811148897,-0.0863946895683762,0.0839247040723985,0.256685655197905,0.424071933611714,0.578458135174377,0.712762108447764,0.820772568394466,0.897436252486934,0.939090998669551,0.943633812235713,0.910616199447404,0.841262613748205,0.738411603158322,0.606382975323465,0.450777823020364,0.278221403499592,0.0960614870271917,-0.0879632404976629,-0.266068907809583,-0.430770071406899,-0.575205324513796,-0.69343014577416,-0.78066405993783,-0.833481603937308,-0.84993947291601,-0.829635408527963,-0.773697720442825,-0.684707632258452,-0.56655975114447,-0.424268726500397,-0.263732457962163,-0.0914639359400508,0.0856951207267878,0.26086525987161,0.427411622767469,0.579205209170617,0.710852165937888,0.817882139259196,0.896889044996565,0.945620154832506,0.963012029785069,0.949174419427102,0.90532565488106,0.833685180799011,0.737330600648583,0.620027879796333,0.486044118632345,0.339952558570025,0.186439230847082,0.0301199418156792,-0.124624827791378,-0.273790966226565,-0.413863229926492,-0.541896488052178,-0.655564793854968,-0.753179072663972,-0.833675751772922,-0.896579945831824,-0.941947796638092,-0.970293213423838,-0.982504555686388,-0.979756753746337,-0.963424001004971,-0.93499752208403,-0.896012082082671,-0.847983922784224,-0.792361765027703,-0.730491475541974,-0.663594029274456,-0.592755563463325,-0.518927663699316,-0.442935576284193,-0.365491820168671,-0.287212673774572,-0.208635219312951,-0.130233008012831,-0.052428920911448,0.0243956093621193,0.099895234872079,0.173758820229488,0.245710190425453,0.315510245194947,0.382958959776486,0.447895739309233,0.510196720078601,0.569767905268896,0.626533461808535,0.680419052148899,0.731330684714268,0.779130187365186,0.82360898513349,0.86446234383903,0.901266577583207,0.933461872229637,0.960343322695361,0.981062507514161,0.994641433832433,1,0.995997276781303,0.981485950956946,0.955378266386684,0.916720804173435,0.864774534963758,0.799095820523541,0.719613500180476,0.626696921611792,0.521209801518198,0.404545149360732,0.278637156590396,0.145946924506574,0.00942013603851165,-0.127583787856164,-0.2613899414628,-0.388130882080161,-0.50388999528605,-0.604859580162135,-0.687506767472059,-0.748739505736394,-0.78606434936442,-0.797727706418356,-0.782832575778792,-0.741423624448257,-0.674534700027213,-0.584194490725633,-0.473387962531556,-0.345973327859427,-0.206556524908365,-0.060327395678705,0.087136176149757,0.230088084046171,0.362848224826181,0.48004056219813,0.576823949320253,0.649104677218046,0.693720326830962,0.708585661097505,0.692792951902582,0.646661219016236,0.571731264102492,0.470705992862757,0.347338199588152,0.206270601813586,0.0528353206337755,-0.107177924440887,-0.267774011526645,-0.423013021498899,-0.567266784873979,-0.695459051227356,-0.803277742218118,-0.887349126438108,-0.945365660786198,-0.976161582413316,-0.979732987034126,-0.957201955406352,-0.910727141545566,-0.84336596290696,-0.758895989270574,-0.661605182098296,-0.55606217935382,-0.446878768985718,-0.338476996085521,-0.234872987580812,-0.139488573536143,-0.0550001900646648,0.0167675479443707,0.0748987014456528,0.11939112470792,0.151110522769172,0.171696915375379,0.183429558093426,0.189058608520882,0.191613592971603,0.194199929715995,0.199795333089048,0.211057827856516,0.23015635126939,0.258633553938898,0.297308507033241,0.346224689445121,0.404645995839199,0.471100723146361,0.543470716127528,0.619120239036832,0.695056838284975,0.768114601279412,0.835148905656884,0.893231066645409,0.939831269003733,0.972978817158888,0.991390018295072,0.99455585774794,0.982783931449855,0.95719173713016,0.919651245874323,0.872687518737853,0.819336837462979,0.762972228948658,0.707106240662818,0.655182252967048,0.610366408930646,0.575352352485758,0.552190379856873,0.542151354427156,0.545633876835278,0.562120839878679,0.590188760602169,0.627570320730848,0.671267526093275,0.717709985244589,0.76295017170247,0.802885323570991,0.833493976818541,0.85107412221473,0.852469683507684,0.835272459165313,0.797987834407731,0.740154396685702,0.662409981367147,0.566499508151804,0.455223090257395,0.332326138252092,0.202336361287794,0.0703555151128086,-0.0581837050345706,-0.177783220614364,-0.283153815982061,-0.369483696279073,-0.432687132380015,-0.469619891861374,-0.478249803300409,-0.457773089218556,-0.408669910151718,-0.332695739202185,-0.232808562664515,-0.113035295958381,0.0217159685038409,0.165888379019517,0.313541518307107,0.458635726002843,0.595320871152838,0.718214647843953,0.822656017418813,0.904920740821313,0.962387963983396,0.993649429080807,0.998555943956477,0.978199085430774,0.934829558417061,0.871716994912647,0.792959072792165,0.703250496216995,0.607624463488276,0.511180642082653,0.418814300025759,0.334961075201535,0.263370910884491,0.206923000994068,0.16749126664166,0.145867055647661,0.14174257572979,0.15375521592288,0.179589564725801,0.216130781810991,0.259660196118282,0.306081739371753,0.351166204019773,0.390799425931149,0.421220381810324,0.439235862872518,0.442399800065056,0.429147391049428,0.398876797621684,0.351974196479507,0.289781206601991,0.214507000911407,0.129090553960413,0.0370213047270179,-0.0578711344066937,-0.15164584673868,-0.24048464324947,-0.320917566763407,-0.390026681393357,-0.445616215825183,-0.486339065864419,-0.511772171560175,-0.522436226431545,-0.519758385642249,-0.50597993586041,-0.484014086173983,-0.457261956032331,-0.429397307111992,-0.404132450021404,-0.384978944948145,-0.375017137271688,-0.376688196871785,-0.391621179605649,-0.420505760879931,-0.463018804352366,-0.517809958383045,-0.582548181280383,-0.654027664688275,-0.728328242426346,-0.801022227830491,-0.867416892211359,-0.922819634741503,-0.962811423854564,-0.983513398791493,-0.981831651811954,-0.955666166598298,-0.904071621389898,-0.82736018863668,-0.727139450667092,-0.606281945909856,-0.468826482550453,-0.319815012842161,-0.165072355476093,-0.010939197010527,0.13602857417556,0.269379190044166,0.38308678505051,0.471859098331251,0.531415076404909,0.558717719098302,0.552149648347147,0.511621682920161,0.438608028353624,0.336105369037081,0.208516988331526,0.0614668440527051,-0.0984479063067353,-0.263954288296074,-0.427436592752119,-0.581289097226797,-0.718271323504366,-0.831848547405537,-0.916500966491679,-0.967986453911213,-0.983544102705354,-0.962028676178211,-0.90396947613011,-0.811550847504323,-0.68851536615503,-0.539994511996662,-0.372275123987162,-0.192512992471414,-0.00840741847590133,0.172147659904731,0.341419388178966,0.492181816835542,0.618035739603137,0.713687906277053,0.775177105206432,0.800037326605925,0.787391367763451,0.737971660486261,0.654068614464754,0.539410200784484,0.398979678347576,0.238781139483086,0.0655647903795177,-0.113474511939671,-0.291011036115508,-0.459899653444742,-0.613470934376485,-0.745796984010326,-0.851916925614031,-0.928013212363245,-0.971532571396368,-0.981248217689045,-0.957262868689021,-0.900954896353223,-0.814872532907665,-0.702583278507833,-0.568487443624231,-0.417606023984806,-0.255353808749504,-0.0873087518893693,0.0810117882455675,0.244358267709904,0.397931326115694,0.537532705069669,0.65968005648206,0.761683043425256,0.841680203281684,0.898638004840816,0.93231528891515,0.943197753356647,0.932408265693586,0.901599520433511,0.8528358878955,0.788471235563283,0.711029071917109,0.623090616399195,0.527195402977166,0.425757854932179,0.321002007004848,0.214915280390235,0.109221014241137,0.00536839314770045,-0.0954624606221667,-0.192343098483027,-0.284570310044759,-0.371634011342667,-0.453182701565388,-0.528989389756052,-0.598920374624925,-0.662908619498626,-0.720932758568937,-0.77300205955902,-0.819147008565375,-0.859414625415204,-0.893867202663594,-0.922582916000841,-0.945656691716881,-0.96319983639103,-0.975337218992749,-0.982201216788404,-0.983922153713737,-0.980615525290202,-0.972366865684554,-0.959215617834137,-0.941139768067854,-0.918043261103852,-0.889748289036685,-0.855994431349079,-0.816446309181924,-0.770710918442073,-0.71836515002052,-0.658993231972856,-0.592232989409034,-0.51782897210967,-0.435689710352498,-0.345945688447653,-0.249004130595372,-0.145596423509497,-0.0368139907906516,0.0758712943030529,0.190605515472464,0.305172473511732,0.417036276576399,0.523406997065067,0.621328274589134,0.707784347364985,0.779822640479775,0.834686814001097,0.869954158543438,0.883670493816691,0.874475336630216,0.841710101042245,0.785502496285058,0.706821096344231,0.607495243531246,0.490196968862667,0.358383395206659,0.216200047753465,0.0683475297165057,-0.0800839795683685,-0.223806092838673,-0.357541536042306,-0.476242255818695,-0.575306322963167,-0.650783306845673,-0.699557984798117,-0.719502970207539,-0.709592071651607,-0.669967882762719,-0.601959172227063,-0.508045996350895,-0.39177297614807,-0.257613738370593,-0.110791981838869,0.0429331343801959,0.197507697673738,0.346838827337078,0.485053626733153,0.606749086898446,0.707221040869485,0.782661192706932,0.830312739805301,0.848577100371035,0.837066651165061,0.796601052456649,0.729147550099442,0.637708452242645,0.526161632828595,0.399062274979468,0.261416008492162,0.118435012341213,-0.0247105318376226,-0.163133081200482,-0.292448403659601,-0.408965338804281,-0.509835403482898,-0.593155179303317,-0.658016968523309,-0.704505984738192,-0.733645205559708,-0.747291801469605,-0.747991617241635,-0.738800380747067,-0.72308202923604,-0.704295682255277,-0.685783291668371,-0.67056983624322,-0.661187111003632,-0.659530736193348,-0.666758057147427,-0.683232233846958,-0.708515160066693,-0.741409055506328,-0.780043796664381,-0.822004449155206,-0.864491181830459,-0.904501909864574,-0.939026733356431,-0.96524258262078,-0.980696488834124,-0.983466569489921,-0.972291115265868,-0.946658016048985,-0.9068490651456,-0.85393630249277,-0.789730351766064,-0.716683514100163,-0.637753042709785,-0.556232385576835,-0.475560111288928,-0.399117613730926,-0.330027442681747,-0.270964182636631,-0.22398919252574,-0.190419254285621,-0.170737325541533,-0.164551251732362,-0.170603594820408,-0.186832829372457,-0.210483205199521,-0.238257745584829,-0.266506302519259,-0.291438471757861,-0.309349604405959,-0.316847231599382,-0.311065002649031,-0.289851743803485,-0.251924453280846,-0.196975897785214,-0.125729869433427,-0.0399399718347544,0.0576691222544289,0.163515829879362,0.273326031298377,0.382339616276244,0.485548732359243,0.577955382807413,0.654834796875132,0.711990499701605,0.745987276629257,0.754349248968923,0.735712005175644,0.689920074140512,0.618063862539672,0.522453354846666,0.406529222062819,0.274715322500241,0.132219723707521,-0.0152058429472687,-0.161535917208706,-0.300756831649798,-0.427153124776405,-0.535580040966199,-0.621707995776087,-0.682226326101398,-0.714995767713205,-0.719141794724826,-0.695084072186208,-0.644500646502792,-0.570228946669265,-0.476109006006241,-0.366777358658046,-0.24742265276887,-0.123516013024087,-0.0005304716263925,0.116335700309348,0.222417216381795,0.313808079905701,0.387544291414591,0.441733699231199,0.475626644534581,0.489624294615784,0.485224953703029,0.464912003722694,0.431990273597109,0.390380393339626,0.344382908148096,0.298425487714551,0.256807383410066,0.223455318351039,0.201704243540398,0.194114901593224,0.202337993161556,0.227032061340249,0.267839146704076,0.323418991823757,0.391539272207577,0.469216184970346,0.552896912524933,0.638673152900096,0.722513200168895,0.800499062582885,0.869054877145167,0.925153429400986,0.966488884485811,0.991605806431425,0.999977076139594,0.992026271482401,0.969093279262802,0.933345187500781,0.887637672653929,0.835334970927545,0.780098942802916,0.725659567483218,0.675580334177695,0.633032363861898,0.600590674783901,0.580064817931034,0.572374218292575,0.577476066968468,0.59435065484492,0.621045784001703,0.65477851901323,0.692089235141656,0.729039869472571,0.761445656517136,0.78512758115375,0.796171427378956,0.791178721816013,0.767495104594873,0.723402700775963,0.658264862205232,0.572614109994371,0.468177102219346,0.34783382042856,0.215511731249562,0.0760192432575933,-0.0651738493944158,-0.202198250664555,-0.329076235213498,-0.440026997541945,-0.529770370700818,-0.593812851669281,-0.628700567870535,-0.632225338957085,-0.603572254830614,-0.5434000895825,-0.453849252290242,-0.338475663860241,-0.202112752016061,-0.0506674751315973,0.109140275104684,0.270082562921496,0.424757897838325,0.565939011381613,0.686916814634333,0.781823506423135,0.845918745578012,0.875824563791905,0.869697187781087,0.827327032672589,0.750161663976779,0.64125032192394,0.505112465330725,0.347536525876457,0.175318478731335,-0.00404723965168299,-0.182709646376783,-0.352819597139469,-0.506887556494217,-0.638123795577045,-0.740745022675115,-0.810233194922565,-0.843534686535357,-0.839190971112698,-0.797395356656872,-0.719973917830653,-0.610292417283236,-0.473094513905423,-0.314279747909696,-0.140632516747536,0.0404846154119928,0.221458493515172,0.39475836154814,0.553258872337046,0.690538546475152,0.801140621378932,0.880785339597625,0.926525309862757,0.936838493511259,0.91165646792453,0.852328737518429,0.761526845031411,0.64309473633599,0.501854124474699,0.343375381715906,0.173725690247303,-0.000793236816405529};
	return dA;}
double* dE_init(){
	static double dE[1001]={-0.000399472861698717,-0.180450758831481,-0.349441149793851,-0.500247622980461,-0.626512527838734,-0.72294436855942,-0.78556902420596,-0.811918180932323,-0.801144947910317,-0.75406039105706,-0.67308884357185,-0.562144115179821,-0.426432889313286,-0.272195439812861,-0.106397103748051,0.063613468560015,0.230461544866834,0.387100521706959,0.527144854092862,0.645164673911808,0.736927216352556,0.799573122485526,0.831719268991855,0.833483792548177,0.806433202092518,0.753455671448271,0.678568544052077,0.586671542739567,0.483259970440695,0.374114160589874,0.26498248460549,0.161275296487473,0.0677862957513448,-0.0115440207736756,-0.073810758952985,-0.117264075117916,-0.141360574664455,-0.14674550663222,-0.135168547739304,-0.109339696578898,-0.0727350921163667,-0.0293652444847607,0.0164799277893474,0.0604938236608423,0.098608101795719,0.127225091981287,0.143414585827233,0.145064323526435,0.13097649761189,0.100906010158997,0.055539837510379,-0.00357954338605319,-0.0741803476074244,-0.1534280452421,-0.238120726879238,-0.32490013032757,-0.41046444955405,-0.491769183382905,-0.566203277467807,-0.631729601140133,-0.686981265370871,-0.731308272495948,-0.764772304143137,-0.788090892400163,-0.802535564652339,-0.80979159437411,-0.811789536715441,-0.810520617520397,-0.807849156250553,-0.805335463763559,-0.804082044107531,-0.804614478532096,-0.806806165151186,-0.809853261839258,-0.812302905268578,-0.812134257073662,-0.806888377759626,-0.793839572979057,-0.770197908497496,-0.733330240279952,-0.680985510995196,-0.611509335953784,-0.524033100672838,-0.418623923758573,-0.296383850800551,-0.159489431428344,-0.0111662380138146,0.144403283733958,0.302236208027212,0.456763344593,0.602091135322501,0.73229787670286,0.841748406604011,0.925409759268899,0.97914964400666,1,0.986369320426181,0.93818986137497,0.856989134273987,0.745879052223463,0.609460545725044,0.453646135996045,0.285407591732984,0.112460133196144,-0.05710156559035,-0.215197313530142,-0.354164960315661,-0.467152291433565,-0.548476169558776,-0.593929191075487,-0.601016593302962,-0.569109600457597,-0.499505656143649,-0.395390831884033,-0.261704864756283,-0.104914482008862,0.0672943688634338,0.246390324117471,0.423417705932375,0.589443485442733,0.736007097130935,0.855549746087722,0.941800751122769,0.990100577338192,0.997643423715839,0.963626375842515,0.889296990750952,0.777896489988577,0.634501213061803,0.465770331279699,0.279612753241149,0.0847904017334594,-0.109521621306776,-0.294195219150674,-0.460606036067744,-0.601063175919872,-0.709189813703228,-0.780235255660258,-0.811302669861673,-0.801481195465204,-0.751876200774419,-0.665536823268019,-0.54728529959729,-0.403457691870445,-0.241570166922605,-0.069928747890074,0.102796763016786,0.268012335494807,0.417629926321926,0.544466308576378,0.642590384374657,0.707601814263912,0.736827632490709,0.729428008804877,0.686407214127962,0.610530880276376,0.506155540020135,0.378980931262371,0.235739411635508,0.0838398590081074,-0.0690145205421324,-0.215214086566046,-0.34761611023216,-0.459884546095627,-0.546779421937546,-0.604382113063882,-0.630246512588735,-0.62347030751894,-0.584684983223653,-0.515967560267913,-0.420681178416324,-0.303255263529764,-0.168918956455643,-0.0234036028022754,0.12736869843337,0.277593254796077,0.421871135131177,0.555462813833655,0.674494584995557,0.776108236915973,0.858547927434807,0.921181885916521,0.964460275707826,0.989814072874838,0.99950296017919,0.996422833192171,0.98388543704735,0.965383808350267,0.944357543889161,0.923971459969148,0.906919993188355,0.895267816822791,0.890334733625029,0.892630109847101,0.901839108254089,0.916859938479987,0.935888446509181,0.956543773016266,0.976026661864814,0.991300404318456,0.999283434991641,0.997042287016658,0.981973961426951,0.95196772630146,0.905537857299451,0.841920756601906,0.761132114191989,0.663982162851904,0.552049480850323,0.427616073148899,0.293568484973361,0.153271362771645,0.0104210948517531,-0.131112114695985,-0.267445179760817,-0.39483781282201,-0.509835450873602,-0.60939307651406,-0.690975037289738,-0.75262761648766,-0.793022842999231,-0.811473733945713,-0.807922735885854,-0.782906476660943,-0.737500987405724,-0.673252253236918,-0.592097277456179,-0.496280799831791,-0.388272421858291,-0.270688210457603,-0.146219944261426,-0.0175741142671318,0.112578318897137,0.241641487225635,0.367124537682004,0.486663734456019,0.598039099965819,0.699188217148674,0.788219790995213,0.863429264143886,0.923318231140695,0.96661864938026,0.992321967829538,0.999712363876385,0.988402375288321,0.958368418329614,0.909983067427269,0.844040596658289,0.761772191821915,0.664847456427835,0.555359355439382,0.435790543883049,0.308960068426788,0.177950644527886,0.0460180204668492,-0.0835147466632817,-0.207374052245825,-0.322458444959493,-0.425961383012882,-0.515487703219796,-0.589157377464148,-0.645690448085151,-0.684467749107039,-0.705563106213915,-0.709744111789226,-0.698440216504349,-0.673678671903647,-0.637990692581628,-0.594291969149942,-0.54574324248611,-0.495597942139996,-0.447044808635387,-0.403053893144489,-0.366234316866769,-0.338711663761353,-0.322031892038877,-0.317097230218618,-0.324137748722541,-0.342720267833972,-0.371794095423405,-0.409770912320352,-0.454634072134193,-0.504070783449782,-0.555619210576644,-0.606821559138478,-0.655373772992093,-0.699262596256381,-0.736881451445946,-0.767117819648848,-0.789406515434504,-0.803745331444818,-0.810671864104154,-0.811202783210763,-0.806739225116951,-0.798944221643606,-0.78959998297646,-0.780454307867518,-0.773066298939359,-0.768661846879496,-0.768008983404904,-0.771322196770429,-0.77820320241167,-0.787623549523592,-0.797951939421498,-0.80702637736618,-0.812268438452654,-0.810834171354683,-0.799793661135729,-0.77632918243028,-0.73794033426497,-0.6826436649156,-0.609154139842383,-0.517036406398776,-0.406815149752935,-0.28003585504066,-0.139269889297572,0.0119391451081052,0.169187523253792,0.327378318303487,0.480936186036002,0.624060087721041,0.75100152825827,0.856354028496807,0.935338453808024,0.984068565322437,0.999781778863467,0.981021593006842,0.927760415893075,0.841454468026115,0.725025912246299,0.582771176849327,0.420198385631097,0.243800670978238,0.0607757061671185,-0.121295151986453,-0.294792346038423,-0.452410912188903,-0.587502640661833,-0.694389990650688,-0.768635438872452,-0.807252126663158,-0.808844639537629,-0.77367234829717,-0.703631768995464,-0.602158641739996,-0.474054653456851,-0.325247705124279,-0.162498130137162,0.00693388676980977,0.175642419068696,0.336433077588015,0.482665006692507,0.608560050482834,0.70946339606653,0.782042699660469,0.82441609353924,0.836203367812637,0.818498802902087,0.773768362990133,0.705678011906865,0.618863556232173,0.518655455015773,0.410774295869139,0.301014002290083,0.194930237354686,0.0975508899814504,0.0131240133057881,-0.055083774980403,-0.104928480866932,-0.135463141014971,-0.146942967532831,-0.140762721422257,-0.119331631127952,-0.0858946328656144,-0.0443116083041795,0.00119152901645179,0.0462847126536583,0.0867929565314316,0.118937829558584,0.139547439692443,0.146223367303964,0.137455811903547,0.112681517041959,0.0722826126218007,0.0175281442614277,-0.0495364736755446,-0.126243749291543,-0.209491276795021,-0.295949066335686,-0.38227331060821,-0.465312702920294,-0.542294135864049,-0.61097614435743,-0.669760711501659,-0.717756886445273,-0.754792891205771,-0.78137681496765,-0.798609394756951,-0.808055546904937,-0.811584045031592,-0.811186864631783,-0.808791096143703,-0.806076877620572,-0.804314476077893,-0.804232468376572,-0.805927006462951,-0.808819515585027,-0.811667027853423,-0.812625890285572,-0.809366020746398,-0.799229439966358,-0.779423701051823,-0.747238269249489,-0.700270043190016,-0.636643182209327,-0.555208291025264,-0.455706836748257,-0.338888400898075,-0.206570912334677,-0.0616372265625669,0.0920348695477016,0.249708155929153,0.405981872216917,0.555039058680969,0.690932991899627,0.80789759947025,0.900664797497122,0.964770708026254,0.99683275921645,0.994780767808651,0.95802720919273,0.88756489338168,0.78598402942249,0.657404974119429,0.507327586427411,0.342402787843254,0.170136395916033,-0.00146070487648877,-0.164258697625466,-0.310411524413906,-0.432755046115682,-0.525179384785279,-0.582955136931357,-0.602995254208618,-0.584037529163311,-0.5267366372704,-0.433659361697032,-0.309181713979707,-0.159291886665463,0.00869195266476337,0.186475372551276,0.365195284279814,0.535860788142787,0.689804641292809,0.819121966023364,0.917073303171885,0.978430831699242,0.999749436230173,0.979548160188114,0.918392228790917,0.818871015316785,0.685472777090492,0.524362410950001,0.343073579044506,0.150131059456974,-0.045377160490127,-0.234255904364566,-0.407663348144453,-0.55755229708244,-0.677069480051261,-0.760892413317822,-0.805486731506795,-0.809271121740634,-0.772681896303452,-0.698134533586822,-0.589884920390246,-0.453798250448023,-0.297038295575578,-0.12769381517349,0.0456380044258335,0.214289146783488,0.369956604647621,0.505114025530354,0.613378270205163,0.689812622918813,0.731151959500196,0.735939478971208,0.704569395120597,0.639235002414217,0.543786502241551,0.423507633666397,0.284824251179853,0.134961318149539,-0.0184328282592328,-0.167674750042041,-0.305426299633976,-0.425047579327167,-0.520904818595814,-0.58861832654958,-0.625239220995882,-0.629347708599324,-0.601070059150168,-0.542015835992518,-0.455141171291548,-0.34454768167756,-0.215229807486695,-0.0727857664659902,0.0768911736527961,0.227923841724089,0.374747872510408,0.512378444452024,0.636633653374071,0.744303950728395,0.833260400292215,0.902498137641776,0.952115140807007,0.983230026937944,0.997845879236392,0.998669904554026,0.988900881198945,0.971997774839675,0.951443519043638,0.930517764155332,0.91209142872489,0.898454219752167,0.891184037586058,0.891064494458735,0.89805381921908,0.911305372350777,0.929237032346075,0.949644004209059,0.969847290822265,0.986868277920215,0.997618699329248,0.999094718852011,0.988563996962832,0.963735373692641,0.92290212717358,0.865051562895168,0.789935830323594,0.698101213592011,0.590875556571273,0.470315816425183,0.339119860512475,0.200508413789021,0.0580844364318053,-0.0843218981410964,-0.222814077085815,-0.353587559626529,-0.473077724127218,-0.578090678431914,-0.665911524864489,-0.734386268046689,-0.781975272679562,-0.807777906178759,-0.811529628845339,-0.793574224923439,-0.754815021690866,-0.696649762853954,-0.620894254122637,-0.529699976280026,-0.425470583379957,-0.310781613454246,-0.188306898620636,-0.0607541479332762,0.0691889240951367,0.198897648727659,0.325843370438039,0.447617914970336,0.561951766483605,0.666728520282711,0.759998249180691,0.839992208788558,0.905140834422795,0.954096294517864,0.985760023864236,0.999314738267477,0.994259510656978,0.970445648362059,0.928110428100107,0.867905284206679,0.790914856022776,0.69866341177093,0.593105586225858,0.476599082468993,0.351857956028246,0.221886264529204,0.0898931528318797,-0.0408082340202545,-0.166914352337176,-0.285252601890981,-0.392904753132747,-0.487326229934973,-0.56645480629002,-0.628802457951396,-0.673524694389197,-0.700462663574569,-0.710154627085292,-0.70381497724742,-0.683280723073801,-0.650927204544957,-0.609556593844195,-0.562264394615594,-0.512290549053749,-0.462862813331097,-0.417040689315544,-0.377568353906115,-0.346744684002831,-0.326317642844766,-0.317409010488348,-0.320473774744642,-0.335296541500483,-0.361025187727278,-0.396239792928466,-0.439052777619271,-0.487234280924655,-0.538355243593549,-0.589939529879304,-0.639615799508559,-0.685259777182109,-0.725118076144546,-0.757905793769885,-0.782871655880752,-0.799826455984069,-0.809132802102178,-0.811656613197742,-0.808683252421162,-0.801803494706193,-0.792776555995459,-0.783379029250477,-0.775249669633883,-0.769740468769687,-0.767784311818284,-0.769788715753559,-0.775563736796043,-0.784290181833305,-0.79453186992023,-0.804293001545957,-0.811118862457764,-0.812235284776359,-0.804719682431629,-0.785694233998359,-0.752530049126183,-0.703050043065903,-0.635717840624944,-0.549800379087352,-0.445492978215728,-0.323997448770299,-0.187546230560373,-0.0393684600001931,0.116402893086281,0.274880290550989,0.430621419735517,0.577870539031273,0.710829720622715,0.823946249304885,0.912201074625847,0.971382671469958,0.998330990752884,0.991137377292345,0.949288346472716,0.873743847603588,0.766943959580367,0.632741687845918,0.476263459117443,0.303702825604861,0.12205657472949,-0.0611843151465456,-0.238373814555252,-0.402063182466229,-0.545348664611068,-0.662196719984257,-0.747729920765251,-0.798458568423953,-0.812445792108061,-0.7893973017195,-0.730670875228494,-0.639204856338588,-0.519369195669159,-0.376746652538481,-0.217855460060997,-0.0498278397077182,0.119938938341913,0.284140844226858,0.435916193533361,0.569167610634013,0.678840439248471,0.761143621005174,0.813702243237034,0.835634708369118,0.827551589267047,0.791477478168403,0.730701274862018,0.649564162794265,0.553197779654427,0.447227623244671,0.337458407339502,0.229558808492485,0.128762790346508,0.0396034799335363,-0.0343065218385326,-0.0904373585697913,-0.127439057399845,-0.145169790849438,-0.144655433424192,-0.127984484360404,-0.0981460330682896,-0.0588215497220126,-0.0141437157308952,0.0315628660988113,0.0740435093335103,0.109362449413918,0.134124731210477,0.145658614381408,0.142148756889554,0.122713600387786,0.0874238881011554,0.0372628821460049,-0.0259676073811746,-0.0997880280089259,-0.181218628147193,-0.266981557351519,-0.353714040559833,-0.438178695296243,-0.51745748815316,-0.589117096851996,-0.65133547283478,-0.702982056431377,-0.743647213698206,-0.773619844561483,-0.793815543421063,-0.805660960292124,-0.810942907355554,-0.811633099561464,-0.809701059640726,-0.806928551559655,-0.804738875830712,-0.8040534622538,-0.805186481480246,-0.807785768110746,-0.810825351759367,-0.812651511915137,-0.81108071624081,-0.803544291805206,-0.787271435803278,-0.759499403765172,-0.717697599585564,-0.65979097548578,-0.584367726855526,-0.490856779143916,-0.379661997486718,-0.252242334239018,-0.11113014201216,0.0401165487690185,0.197028063735858,0.354399657123795,0.506522919061267,0.647460738148961,0.771351541044597,0.872726299130358,0.946820476281921,0.989862788208524,0.999323391889046,0.974105901478768,0.914670352445064,0.823077769892674,0.702951152206741,0.559352230539054,0.398578055286367,0.227886027555346,0.0551601747744052,-0.111464978624996,-0.264003883546704,-0.395022016023993,-0.498019154345035,-0.567773117907227,-0.60062494054352,-0.594689262923806,-0.54997747254991,-0.468425600641404,-0.353823964429434,-0.211650752426099,-0.0488169051437675,0.126665539039554,0.306075250881335,0.48041381670845,0.640856251471409,0.779196553921957,0.888265107605755,0.962296043841048,0.997225175726841,0.990902656552458,0.943208924694214,0.856067535152261,0.733353875167062,0.580704227466815,0.405234884951905,0.215185752290845,0.0195068377657354,-0.172590970896183,-0.352097600415763,-0.510654092929439,-0.640968302214174,-0.737174653478623,-0.795119639894584,-0.812558693383883,-0.78925477429283,-0.72697421843584,-0.629380779390779,-0.501834118105925,-0.351103936440022,-0.185015263741153,-0.0120438596817788,0.15911688568719,0.319994912615502,0.462761623075283,0.580615648244754,0.668109000827971,0.721399637000832,0.738418533335023,0.718944039595335,0.664581240772565,0.578649079069981,0.465982777906384,0.332663420468235,0.185690139911457,0.0326130938048963,-0.118852910005252,-0.261213669179429,-0.387559765293738,-0.491891273348425,-0.569387132605824,-0.616606629152234,-0.631614362275548,-0.614024363694128,-0.564963468251366,-0.486958351754899,-0.383754622196105,-0.260079764630826,-0.121364422786622,0.0265616784332424,0.177781985631661,0.326596447975428,0.467799854800378,0.596920990102087,0.710411026865914,0.805772762617014,0.881625849410277,0.937706888075118,0.974806925156351,0.994652307020825,0.999737823922857,0.993123461929493,0.978207754718636,0.958491616129195,0.937346610396019,0.917800899753323,0.902354662801375,0.892834705845127,0.890295430315917,0.894970433408524,0.906275981334793,0.922864583795897,0.942724086191601,0.96331523779837,0.981738719488212,0.994921221253035,0.999809408700643,0.993560530310615,0.973718975683102,0.938369244233651,0.88625743600193,0.816875417167213,0.730504109356542,0.628214760438407,0.511829430363243,0.383844131232293,0.24731997400395,0.105749195157012,-0.0370960071986885,-0.177323348316571,-0.311080528827546,-0.434707447713464,-0.544873399012421,-0.638693357928082,-0.713818993066815,-0.768501732404161,-0.801626947869144,-0.812719996042022,-0.801926358666566,-0.769969380348165,-0.718090036415084,-0.647973740070917,-0.56166939924973,-0.461505770647295,-0.35000966630071,-0.229829803055723,-0.10366912013852,0.0257726912863975,0.155845811516523,0.283986482744887,0.407744090519533,0.524801164580021,0.632988777508155,0.730299987556484,0.814903852388237,0.885162150454291,0.939650324579762,0.97718336433758,0.996846440069077,0.998029170695256,0.980461531255732,0.944248662689743,0.889901304964861,0.818358290251687,0.730997541952647,0.629632343100271,0.516490256096976,0.394172964302201,0.265596412774226,0.133911880793215,0.00240993941601983,-0.125589457928569,-0.246856327903725,-0.358374060283337,-0.457460795357315,-0.541882362081879,-0.609950412284739,-0.660599837485988,-0.693440398198719,-0.708778694453426,-0.707608099706447,-0.691565985912812,-0.662859386525073,-0.624162067106136,-0.578487686904721,-0.529045229305653,-0.47908405519867,-0.43173670878521,-0.389867920707801,-0.355938076301566,-0.331888744714707,-0.319056725815283,-0.318121524055837,-0.329089286402785,-0.351314151714068,-0.3835557741394,-0.424069634415922,-0.470724772200953,-0.521141884166335,-0.572843445451261,-0.623406712755385,-0.670610214121696,-0.712564649141955,-0.747820005065088,-0.775442095414483,-0.795053571700861,-0.806836640350387,-0.811497107882331,-0.810191834050933,-0.804424044567707,-0.795913093768157,-0.786447036113976,-0.777727646581918,-0.771218234124276,-0.768004663334265,-0.768679418657431,-0.773257333879484,-0.781129827110142,-0.791062224129472,-0.801236147854643,-0.809336149872871,-0.812676927822567,-0.808364781815697,-0.793484581322037,-0.765301593388565,-0.721466191862932,-0.660208821093662,-0.580512683227625,-0.482252469560997,-0.366289032585973,-0.234512121855897,-0.0898260688369157,0.0639235453521198,0.222080844906767,0.379363461462871,0.530091202491812,0.668448765849338,0.788769380214218,0.885824635277109,0.955104942429352,0.993075101210378,0.997390355627886,0.967060074506491,0.90254869932916,0.805806744889916,0.680228247580674,0.530534939126224,0.362591367352195,0.183158970795036,-0.000399472861682629};
	return dE;}
double* dR_init(){
	static double dR[1001]={0.000481163729076836,0.201260555482506,0.390541985749844,0.559016156804152,0.69840037980891,0.801857081102492,0.864335711273693,0.882820723693919,0.856473467546647,0.786661620707648,0.676875843558228,0.532539328196103,0.36072151890114,0.169772186227423,-0.0311040105680783,-0.232309541512601,-0.424328165749201,-0.598186635289854,-0.74588051546305,-0.860743103401841,-0.937739912631277,-0.973675539828067,-0.967304678766556,-0.919344308244824,-0.832389356699662,-0.710739144305283,-0.560146354962942,-0.387503965248903,-0.200488275059964,-0.00717782481919353,0.18433150907117,0.36629556486006,0.531657081210363,0.674331588943048,0.789431898815612,0.873422916259178,0.924202638528552,0.941109352330845,0.924859012255865,0.87742032477381,0.801838004843168,0.702016870806326,0.582480806490615,0.448121108870617,0.303948370474787,0.154860883704541,0.00544070971210705,-0.140213826180518,-0.278613195404055,-0.40695618949433,-0.523163725826336,-0.625869482453259,-0.714372291329703,-0.788557130023324,-0.84879289996371,-0.895815913735764,-0.930608126246018,-0.954278666728257,-0.967956229132867,-0.972698456580202,-0.969422732924178,-0.958860906174888,-0.94153855344703,-0.917777588344064,-0.887719427808728,-0.851364672995972,-0.808624386471527,-0.759377603545102,-0.7035297037922,-0.641066663265626,-0.572100953706499,-0.496905874197861,-0.415936298519438,-0.329835094287658,-0.239425713099295,-0.145692566459019,-0.0497517063409115,0.0471850422072805,0.143849035748237,0.238953408911349,0.331228196707805,0.419449471436542,0.502460801273404,0.579186291600528,0.648635471169237,0.709901241448521,0.7621529311544,0.804627112160928,0.836619178125898,0.857478725651388,0.866611497357324,0.863490061202008,0.84767455099152,0.818843742801507,0.776835573321444,0.721695014112023,0.653726101457968,0.573543984133271,0.482122180767919,0.380829907830229,0.271454399049184,0.156203610633253,0.0376855870789445,-0.0811379878365484,-0.197024977869122,-0.306551879208957,-0.406236103073368,-0.492676922142962,-0.562708870553566,-0.613559993268378,-0.643006341767881,-0.649513600248761,-0.632356762716227,-0.591709395608795,-0.528695205121564,-0.445396337624401,-0.344814993778478,-0.230787418312956,-0.107851998305116,0.018924094053098,0.144152708173154,0.262357691390325,0.36822192771357,0.456836078809848,0.523936084576368,0.566116626716802,0.581008648216085,0.567410624296924,0.525365521765759,0.456178148226239,0.362370730443281,0.247577896042261,0.116385572760233,-0.025878531678594,-0.173392436993912,-0.32011273322621,-0.460058575920319,-0.58759190795971,-0.69767908309175,-0.78612001473906,-0.849732723962633,-0.886483617634858,-0.895556853722696,-0.877359571240302,-0.833463378719255,-0.76648609430655,-0.67992109955191,-0.577924606687968,-0.465073469599217,-0.346107751296627,-0.225672999712171,-0.108077033890421,0.00292498710016654,0.104305287659003,0.193888619407093,0.270421555275017,0.333583125853995,0.383937599145851,0.422833739678164,0.452258125931431,0.474652856433143,0.492710065207773,0.509156967900636,0.526545591216456,0.547060874897892,0.572359507831904,0.603449752768449,0.640619761446303,0.683418658428677,0.730691182519062,0.780663141423345,0.831071583898055,0.879330638696212,0.922721601474407,0.958594223158709,0.98456537329541,0.998701373323872,0.999671313966959,0.986860527165637,0.960435961482421,0.921358349053499,0.871339553402946,0.812747127538815,0.748461656879249,0.681695681971093,0.615785680650609,0.553970559506378,0.499171225362604,0.453785996940665,0.419515851300001,0.397231816056115,0.386894312444,0.387531075058067,0.397276614995595,0.41347228027557,0.432822045681367,0.451595482020739,0.465866148623018,0.471771132123824,0.465775788232604,0.444927048822814,0.407078992577167,0.351075738198187,0.276879035529659,0.185631072166019,0.0796467986767005,-0.0376657202754654,-0.161954052253089,-0.288132096122713,-0.410641686109092,-0.523750758956449,-0.621871266730309,-0.699878522260654,-0.753413252048031,-0.77914834074786,-0.775004052131448,-0.740298306855539,-0.675822229119849,-0.58383543170874,-0.467980141505562,-0.333117999993021,-0.185097921943448,-0.0304674859051372,0.123856286534307,0.270938436988006,0.404180135770167,0.517655337999371,0.606410997726564,0.666713871365957,0.696230014257825,0.694126974930018,0.66109318933022,0.599273903914167,0.512127823267075,0.404213293009792,0.280916914790951,0.14814080140182,0.0119670172520564,-0.121681027783644,-0.247360427683936,-0.360395221963163,-0.457111048235661,-0.53500487068358,-0.592840674091082,-0.630666569364593,-0.649753565381727,-0.652461029284136,-0.642038291314416,-0.622375679945281,-0.597721264580257,-0.572381554423577,-0.550425234070622,-0.535408660153693,-0.530140323608726,-0.536498895404509,-0.555315982580945,-0.586330544966051,-0.628217322404019,-0.67868688564698,-0.734650347848802,-0.792437644754954,-0.84805486958131,-0.897463648881745,-0.936864126868976,-0.962962878907437,-0.973208018388724,-0.965975838641408,-0.940696415449231,-0.897909495190416,-0.839246465751136,-0.767338972451561,-0.685659499812677,-0.598303691510346,-0.509728042303069,-0.424459619340286,-0.346796459183557,-0.280518107618956,-0.228625360481724,-0.193126640143872,-0.174885694803981,-0.173541597789912,-0.187507574496655,-0.214050265969016,-0.249445952633762,-0.289205324493934,-0.32835390415967,-0.361751490002869,-0.384431229100721,-0.391937335983011,-0.380640156260581,-0.348008269489737,-0.292819588582679,-0.215296821193445,-0.11715701812826,-0.00156999133564813,0.126974159219804,0.262882640438288,0.399751643696734,0.530716378274621,0.648839917101101,0.747518606112704,0.820880370366222,0.864152219339175,0.873974629006486,0.848643194119477,0.788261855131918,0.694796892718482,0.572026471391529,0.425386481285272,0.261719427804948,0.0889388020367096,-0.0843736038130658,-0.249415890632981,-0.397635325116568,-0.521192745806667,-0.613396112923561,-0.669078650535761,-0.68489987722182,-0.659551923533433,-0.59385866333288,-0.490761053527099,-0.355188351627118,-0.193821207546797,-0.0147586461575276,0.172893671452286,0.359492102183639,0.535355570872089,0.691271167960862,0.818977606755161,0.911600517861527,0.96401616226389,0.973124037312266,0.938013810159383,0.860017759943244,0.7426461193614,0.591409030082589,0.413534912389996,0.217600561207063,0.0130929168927668,-0.190074029544203,-0.382061534727247,-0.553601157453705,-0.696456782089767,-0.803829874516332,-0.870687545642051,-0.893997369074882,-0.872858074828635,-0.808520922215992,-0.704302420999248,-0.565394794130135,-0.398585845396384,-0.211904429640021,-0.0142112872670371,0.185242576929389,0.377266625480715,0.553167408038819,0.705149218789059,0.826659454370624,0.912662820403488,0.959832771846239,0.966653304949456,0.933429169141037,0.862207454029114,0.756618060080815,0.621644538931147,0.463339988706091,0.288504960255529,0.104345579099491,-0.081869715637485,-0.263137239147618,-0.433013117581611,-0.585863066824253,-0.71705679180387,-0.823100474440015,-0.901704568838986,-0.951787828435464,-0.973421938462366,-0.967724129973779,-0.93670755517313,-0.883100897409355,-0.810149610168073,-0.72141131471772,-0.620557271253314,-0.511190553122326,-0.396689715103553,-0.280084500272301,-0.163967639304273,-0.0504442316404588,0.0588822739884849,0.162890710033819,0.260894497953347,0.352572087105601,0.437882836241323,0.516975954725849,0.59009988935261,0.657518824999895,0.71944184418303,0.775968865850643,0.82705587682479,0.872500305617486,0.911945790762754,0.944904175856707,0.970791414146288,0.98897325523305,0.998816155357203,0.99973881073357,0.991260040728885,0.973039397336501,0.944907779738878,0.906886401341146,0.859193595428648,0.802240056402119,0.73661410375518,0.663059345517766,0.582447645258873,0.495750523392597,0.404012036633173,0.308325792578517,0.209818108268457,0.109638472779934,0.00895750216156441,-0.0910284311558377,-0.189087660446828,-0.283941345292072,-0.374252393238366,-0.45861861361024,-0.53557349680409,-0.603597634734238,-0.661143094377256,-0.706672067517908,-0.738709911517773,-0.755911354368962,-0.757137263232834,-0.741538077379966,-0.708638891901599,-0.658420347359942,-0.591389016286724,-0.508630940990087,-0.411842401313508,-0.303332877102678,-0.185996486578515,-0.0632498649809101,0.0610635947290213,0.182801101734243,0.29767524936194,0.401430015161991,0.490030004736831,0.559853579582233,0.607879618712211,0.631857350910838,0.63044900785032,0.603335998556207,0.551280863061234,0.476139358155795,0.380819554985456,0.269187650024661,0.145923147676557,0.0163289907056927,-0.113895082960501,-0.238905360818078,-0.35298077478277,-0.450789813696831,-0.527643840404371,-0.579723324424182,-0.604264680870987,-0.599697313943086,-0.565723002357754,-0.503332797936452,-0.414759968112282,-0.303371006855954,-0.173500163539457,-0.0302360936831754,0.120828069232976,0.273867849272499,0.423109077876202,0.563102879469801,0.688979199936547,0.796665325372227,0.88305786547538,0.946139373524612,0.985033985967145,1,0.992360957279001,0.964380348141684,0.919088280845708,0.860071180005507,0.791237623723242,0.716574676526854,0.639909450224781,0.564690105496458,0.493799126632786,0.429409546522587,0.372892002863217,0.324777243565521,0.284775172479744,0.251847955584461,0.224331315362862,0.200095139092045,0.176732102913302,0.15176131960468,0.122833160120062,0.0879214309511736,0.0454900089771992,-0.00537721561770697,-0.0648917704952426,-0.132527059668688,-0.207038105207555,-0.286533279071017,-0.368593259275606,-0.450429271910243,-0.529070013682366,-0.601564663376795,-0.665188217070491,-0.717635102320311,-0.757187665394746,-0.7828476489902,-0.794421094984321,-0.792550075382817,-0.778688089602333,-0.755019651021882,-0.724328285750131,-0.689820643925073,-0.654917452465684,-0.623024418082362,-0.597297759645419,-0.580419698446933,-0.574398909347214,-0.580409642274826,-0.598681030369086,-0.62844513418328,-0.667948707116145,-0.714529721715301,-0.764755612482113,-0.814616222835961,-0.859760842457221,-0.89576571707717,-0.918416202331794,-0.923986466006195,-0.9094994115818,-0.872950330059775,-0.813479650559977,-0.73148295310744,-0.628649970709968,-0.507928434365001,-0.373413059095045,-0.230164464323812,-0.083967094679277,0.0589610048317604,0.19229063793284,0.309918056108443,0.406296534625066,0.476743785677958,0.51770724257889,0.52697150328791,0.503795430444388,0.448970383421811,0.364795572933823,0.254971313420378,0.124415717899599,-0.0209851515230985,-0.174679765829719,-0.329789239867494,-0.479461969680437,-0.617224719956129,-0.737310296075611,-0.834943321814803,-0.906568125163521,-0.950006163802654,-0.964534593631863,-0.950882248120093,-0.911144172659793,-0.848620652811979,-0.767591099251607,-0.673036938573256,-0.570330579726255,-0.464909405168129,-0.361954461737416,-0.266093057004919,-0.181142833736044,-0.109912200532955,-0.054068408138903,-0.0140803004454426,0.0107618997372113,0.0222521992964043,0.0231068808357719,0.0167461830030448,0.00703424982277482,-0.00200550636051763,-0.00648105599319848,-0.00290958680253146,0.011535383317798,0.0388234692304679,0.0799262646042128,0.134744526562616,0.202108239155083,0.27984939429432,0.364942636345515,0.453704528717363,0.542038394765683,0.6257087026205,0.700626994947479,0.763130538081627,0.810235237317657,0.839845918439804,0.850909717793292,0.843501893642441,0.81883765053536,0.779208290586622,0.727844876321849,0.668717303120978,0.606280937207082,0.545186505712582,0.489971500107335,0.44475280247346,0.412940463796378,0.396991528189202,0.398220558076078,0.416680199245333,0.451120925643333,0.499034272541714,0.556778695439171,0.619781996728535,0.682809363354733,0.74028176199408,0.786626015464199,0.816635556195626,0.825819776123294,0.81072014909765,0.769172893427717,0.700500789010732,0.605620709386258,0.487058249670736,0.348866247355955,0.196449686444973,0.036305108609841,-0.124312109423511,-0.277774732079433,-0.416503485295136,-0.533395994790528,-0.622240162254116,-0.678087779979662,-0.697566086265778,-0.679108189954558,-0.623087667175086,-0.531847912252969,-0.40962270872537,-0.262350638974532,-0.0973920179149896,0.0768373338608054,0.251296296828269,0.41678964299294,0.564454673553497,0.686236654727157,0.775326788769523,0.826538326551494,0.836599679994554,0.804347847014121,0.730810869043351,0.619174097659564,0.474631411145167,0.304128835404804,0.116013931214798,-0.0803905203364288,-0.275265859123739,-0.458804352197084,-0.621716430894807,-0.755711344182373,-0.853925716997392,-0.911277398678966,-0.924726106441874,-0.893427475315329,-0.818772928278166,-0.704313951090609,-0.55557555045752,-0.379769548712709,-0.185423601872556,0.0180538609611697,0.220849416681361,0.413235931331865,0.586053670115673,0.731156489881209,0.841800624198752,0.912957000379049,0.941532421605191,0.926490045325189,0.868865096251899,0.771677356740599,0.639747368023545,0.479428160614723,0.29826845406644,0.104626417069273,-0.0927448896602258,-0.285118434572245,-0.464198928982114,-0.622493298144307,-0.75362844479923,-0.852602268134226,-0.915957967030301,-0.94187611151429,-0.930183547404937,-0.882282644709703,-0.801008465646916,-0.69042489901398,-0.555573511860355,-0.402190685708882,-0.236409467760722,-0.0644624705670332,0.10759885406066,0.274155058789921,0.43022863734847,0.571645000607395,0.695139699776359,0.798410447726335,0.880115712862392,0.939824577674295,0.977925007836597,0.995499545311943,0.994178640217903,0.975982336406428,0.943160835403955,0.898043635990034,0.842905573166395,0.779856281499265,0.710757525583381,0.637170627197804,0.560334027429762,0.481168995730641,0.400309760887709,0.318152989434343,0.234920641712282,0.150729826662234,0.0656633502448268,-0.0201648274378694,-0.106554110749979,-0.193175455942989,-0.279545543929451,-0.365017806805561,-0.448789769866398,-0.529924910107175,-0.607386205815432,-0.680077826424002,-0.746891027885012,-0.806750288835822,-0.858656030945458,-0.901720871076759,-0.935197189060173,-0.958494782008417,-0.971188423192733,-0.973016156766316,-0.963870049921984,-0.943781813892843,-0.912906134689943,-0.871504686074014,-0.81993361868311,-0.758636844446589,-0.688146703633546,-0.609092674677351,-0.522217743546819,-0.428400980818106,-0.328683876329995,-0.224297146202607,-0.116684137776206,-0.00751668056557608,0.101300690912234,0.207641766583975,0.309187756080755,0.403476132492255,0.487969523275292,0.560143399649916,0.617589712008648,0.658132075243354,0.679946742893323,0.681682534394976,0.662572192326164,0.622527420889463,0.562210139008948,0.483073284542115,0.387365808413364,0.278098242195854,0.158967320574714,0.0342404742726028,-0.0913965584985525,-0.213023373684017,-0.325691993257288,-0.424647782603311,-0.505553229767459,-0.564702871561556,-0.599217559232241,-0.607206855894321,-0.587889639832777,-0.541664899948688,-0.470127159223519,-0.376023820255858,-0.263154835921825,-0.136218290455169,-0.000608544901710917,0.137823628740444,0.273037199458444,0.399079905179575,0.510365790633652,0.601936732797662,0.669694099509686,0.71058815407223,0.722755011974865,0.705593757263412,0.659779579338903,0.587212310596845,0.490903327470714,0.374807212119747,0.243607655752979,0.102469633007418,-0.0432282640193156,-0.188166387278852,-0.327346358033504,-0.456328720583039,-0.571433030182811,-0.669889776136104,-0.749936454152468,-0.810853458564796,-0.852939062814923,-0.877426378318845,-0.88634860789954,-0.882361932349976,-0.868537803593608,-0.848138117344963,-0.824387599205702,-0.800257709452499,-0.778275457076334,-0.760368771589416,-0.747757621922474,-0.740897050429739,-0.739474896958795,-0.742463437034416,-0.748220673592303,-0.754633823748109,-0.759294833536354,-0.759695706702048,-0.753430179357663,-0.738387891681893,-0.712927726712463,-0.676018373494923,-0.627336340842841,-0.56731446201924,-0.497137211249965,-0.418682690895645,-0.334414716474878,-0.247231795324664,-0.160282744507299,-0.0767610308360224,0.000308515517095296,0.0682762706832634,0.125053565222268,0.169264668457732,0.200354088660287,0.218641029614302,0.225316175344175,0.222379669602816,0.212522983007369,0.198961075378883,0.185224625138224,0.1749248921878,0.171505819664173,0.177999122877102,0.196798275058845,0.229466454397381,0.276591703358925,0.337699868912123,0.411232496041879,0.494592938585596,0.584259767157634,0.675962350138901,0.764909521217981,0.84605877485903,0.914410671108396,0.965311263749388,0.994744518448514,0.999596926316667,0.977877843291399,0.928881430277237,0.853279303158527,0.753136939871566,0.631851302979183,0.49401175872318,0.345190930013821,0.191676335356677,0.040157280752298,-0.102615736224911,-0.230180056898512,-0.336698593380485,-0.417267012535548,-0.468172749462332,-0.487090907790746,-0.473205682866059,-0.427250212220315,-0.351462463505686,-0.249459633529339,-0.126038262684611,0.0130884167127519,0.161600741380516,0.312912587586519,0.460521469861914,0.598348668335493,0.721049962251141,0.824279379302653,0.904891246947402,0.961069578884273,0.992378220433635,0.99972994441608,0.985277545012918,0.952234626307961,0.90463794266136,0.847066567544322,0.78433563912809,0.721183806035482,0.661973693777622,0.610423722410819,0.569387492741473,0.540693854959569,0.525056873868586,0.522060451937061,0.53021764239725,0.547099973765569,0.5695277075376,0.593808136231507,0.61600603698334,0.632228413077573,0.638904805986714,0.633044797074424,0.612455820526318,0.575906983923104,0.523228079576374,0.455337150328298,0.374194586003016,0.282686481289001,0.184444582845627,0.0836143019262413,-0.0154142952566045,-0.108295104432928,-0.191015386084656,-0.260166918260915,-0.313180862124859,-0.348510460306314,-0.365748876931197,-0.365673515831155,-0.35021277353851,-0.322336111066267,-0.285873256621305,-0.245272971250415,-0.205315828525856,-0.170798620108953,-0.146210094736757,-0.135418626328578,-0.141392018364684,-0.165967995524504,-0.209691097129921,-0.271727831101103,-0.349867297031637,-0.440609318767669,-0.539336751206111,-0.640563369448252,-0.738243933593991,-0.826128948410727,-0.898143561024484,-0.948768160968533,-0.973397694329084,-0.968657527551337,-0.932655864538483,-0.865156119724377,-0.767657091652057,-0.643374013886087,-0.497119280909562,-0.335087522229934,-0.164555382274664,0.00648848083022878,0.169763347017707,0.317143288748092,0.441105962801864,0.535157880670754,0.594211671577642,0.614893247351338,0.595760468993082,0.537419697508146,0.442532218495218,0.315708643944457,0.163295667707712,-0.00693437543159845,-0.186175171628036,-0.365038675597642,-0.534043783785177,-0.684115086811226,-0.807064635660944,-0.89603044754472,-0.945847737214209,-0.953332461610812,-0.917461507539923,-0.839439466531841,-0.72264811206301,-0.572481075046791,-0.396072446412911,-0.201933772946645,0.000481163729069555};
	return dR;}

int main(int argc, char **argv) {

	ros::init(argc, argv, "sysid"); // This function need to see argc and argv so that it can perform any ROS arguments and name remapping that were provided at the command line. Third argument is the name of the node
	ros::NodeHandle nh; // NodeHandle is the main access point to communications with the ROS system.
	
	// In the next 4 lines, the node would informs ROS that it wants to either subscribe (read) or publish (write) to a specific topic. The main ROS node would in turn negotiates a peer-to-peer connection with the node. Once the code is terminated, all connections are automatically terminated. The first argument is the topic in question, the second is the message queue (in case messages are published more quickly than they can be sent; the number specifies the number of messages to buffer before throwing the others away). When present, the third argument specifies which call back function to use to store the message in a corresponding global variable.
	ros::Subscriber state_sub = nh.subscribe<mavros_msgs::State>("mavros/state", 100, state_cb);// Subscribes to the relevant ROS topic to read the current state of Pixhawk
	ros::Subscriber rc_in_sub = nh.subscribe<mavros_msgs::RCIn>("mavros/rc/in", 100, rcin_cb);// Subscribes to the relevant ROS topic to read RC channel values
	ros::Subscriber manual_in_sub = nh.subscribe<mavros_msgs::ManualControl>("mavros/manual_control/control", 100, manual_cb);// Subscribes to relevant ROS topic to read manual control (trims + normalized pilot inputs
	ros::Publisher actuator_pub = nh.advertise<mavros_msgs::ActuatorControl>("mavros/actuator_control", 100);// Publishes in the relevant ROS topic to actuate servos/ props to desired normalized values

	ros::Rate rate(100.0);// Sets the rate at which ROS refreshes the while loop (basically helps determine how much it has to wait for the next cycle to obtain the necessary rate)

	while (ros::ok() && !current_state.connected){// Waits until the program determines that the connection to the Pixhawk is established
		ros::spinOnce();// Ensures that all the processes ROS has in queue are finished
		rate.sleep();}// Waits the appropriate time to ensure the rate prescribed is achieved
		
	double * t = t_init();
	double * dA = dA_init(); 
	double * dE = dE_init();
	double * dR = dR_init();// initializes arrays to store values from csv file. t -> time, dA-> aileron command, dE -> elevator command, dR-> rudder command
	int counter = 0;// variable to keep track of the line at which the .csv file the code is and to assign its values to  the corresponding position along the arrays

	mavros_msgs::ActuatorControl act_con;// Initializes variable used to actuate servos
	double t0 = 0;// Records initial time
	double dt = 0.02; // Length of time step of multisine maneuver
	int PWM_max = 2073;// Max PWM value for channel 6
	int PWM_min = 967;// Min PWM value for channel 6
	double amp_gain = 1.0/(1.0 * (PWM_max - PWM_min));// Determines the gain for the amplifier of the multisine signal (based of the value of channel 6). Range = {0,1}
	double amp = 0.0; // Amplifier based on the rc input from channel 6
	int phase = 0;// The phase of the maneuve. 0 when off and 1 when it is being executed
	double dA_com = 0.0, dE_com = 0.0, dR_com = 0.0;// Initializes the commanded actuator inputs

	//Main while loop of the script. This is where the script monitors pilot's input to channels 5 and 6. Decides to executes the maneuver if channel 5 is triggered. Channel 6 determines amplitude
	while(ros::ok()) {

		switch (phase) {
			case 0:// The "off" phase: the script merely passes pilot's manual inputs. If switch for channel 5 is flipped, it resets initial time, intiializes maneuver and transitions to phase 1
				dA_com = 0.0; //Sets demanded aileron deflection to zero
				dE_com = 0.0; //Sets demanded elevator deflection to zero
				dR_com = 0.0; //Sets demanded rudder deflection to zero
				if (rc_input.channels[4]<1500){ //Condition to check if the switch for channel 5 is flipped
					t0 = ros::Time::now().toSec(); //sets the initial time of the maneuver 
					counter = 0; //sets the counter of the sequence to zero (uses same counter used to extract data from the .csv file
					phase = 1; //Changes the phase to "on"
					amp = amp_gain * (rc_input.channels[5] - PWM_min); //computes the gain of the multisine maneuver deflection of the control surfaces based of rc channel 6;
					dA_com = dA[0] * amp; //assigns initial demanded aileron deflection of the maneuver 
					dE_com = dE[0] * amp; //assigns initial demanded elevator deflection of the maneuver
					dR_com = dR[0] * amp;} //assigns initial demanded rudder deflection of the maneuver
				break;
			case 1://The "on" phase: the script sequentially executes the pre-scripted multisine maneuver. Flipping the switch of channel 5 terminates and resets the maneuver. Channel 6 controls the gain of the multisine
				amp = amp_gain * (rc_input.channels[5] - PWM_min); //computes the gain of the multisine maneuver deflection of the control surfaces based of rc channel 6;
				while ( t[counter] + dt + t0 < ros::Time::now().toSec()) { //Assumes the code's refresh rate is significantly faster than the prescribed time step of maneuver. Checks if the time elapsed since the start of the maneuver has exceeded the next time step. If so it updates the counter until it reaches the position of the highest time step during the maneuver less than the elapsed time
					counter++;} // Updates counter
				if (counter > 1000 || rc_input.channels[4]>1500){ //Checks for either of the conditions which would terminate the maneuver: Whether the time elapsed exceeds the total time of the maneuver or whether the switch for channel 5 have been flipped to the "off" setting
					dA_com = 0.0; // resets the aileron deflection to zero
					dE_com = 0.0; // resets the elevator deflection to zero
					dR_com = 0.0;// resets the rudder deflection to zero
					phase = 0;} // Resets the phase to "off"
				else {
					dA_com = dA[counter] * amp; // Passes the desired aileron deflection at the corresponding time step
					dE_com = dE[counter] * amp; // Passes the desired elevator deflection at the corresponding time step
					dR_com = dR[counter] * amp;} // Passes the desired rudder deflection at the corresponding time step
				break;
		}

		act_con.controls[0] = max( min( dA_com + manual_input.y, 1.0), -1.0); // writes the desired aileron deflection along with any pilot inputs or trims and clips the signal to the range (-1, 1)
		act_con.controls[1] = max( min( dE_com - manual_input.x, 1.0), -1.0); // writes the desired elevator deflection along with any pilot inputs or trims and clips the signal to the range (-1, 1)
		act_con.controls[2] = max( min( dR_com + manual_input.r, 1.0), -1.0);// writes the desired rudder deflection along with any pilot inputs or trims and clips the signal to the range (-1, 1)
		act_con.controls[3] = max( min( 0.0 + manual_input.z, 1.0), 0.0); // writes the manual throttle setting and clips the signal to the range (0, 1)

		actuator_pub.publish(act_con); // Publishes the desired actuator control to the relevant ROS topic. MAVLINK and the Pixhawk take care of the rest from here on.
		ros::spinOnce(); // Nudges ROS to take wrap up any lingering threads or processes before the beginning of the next iteration of the while loop 
		rate.sleep(); // Pauses the while loop for enough time to ensure the prescribed rate is respected. Note that this may not be possible if the time required to process an iteration of the while loop exceeds the period corresponding to the rate.
	}

	return 0;
}
